{"mappings":"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","sources":["src/index.ts","src/Autocomplete.tsx"],"sourcesContent":["import Autocomplete from './Autocomplete';\nimport './index.css';\n\nexport default Autocomplete;\n","// eslint-disable-next-line import/no-unresolved\nimport React, { useState, useEffect, useRef } from 'react';\nimport './index.css';\n\ninterface AutocompleteProps {\n  field: string,\n  size?: number,\n  onTermSelected: (term: string) => void,\n  apiKey: string,\n  placeholder: string,\n}\n\nfunction Autocomplete({\n  field, size, onTermSelected, apiKey, placeholder\n}: AutocompleteProps) {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [searchResults, setSearchResults] = useState < { name: string, count: number }[] >([]);\n  const [focus, setFocus] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [isActive, setIsActive] = useState(0);\n\n  const timer = useRef(null);\n\n  const clearResults = () => {\n    setSearchResults([]);\n  };\n\n  const fetchResults = async (): Promise<void> => {\n    setErrorMessage('');\n    setIsActive(0);\n\n    if (!focus) return;\n\n    setIsLoading(true);\n\n    if (searchTerm.length === 0) {\n      const debouncedTimeout: null | ReturnType<typeof setTimeout> = timer.current;\n      setIsLoading(false);\n      if (debouncedTimeout !== null) clearTimeout(debouncedTimeout); //\n\n      clearResults();\n      return;\n    }\n\n    let reqURL = `https://api.peopledatalabs.com/v5/autocomplete?field=${field}&text=${searchTerm}`;\n    if (size !== undefined) reqURL += `&size=${size}`;\n\n    const response = await fetch(reqURL, {\n      headers: {\n        'X-API-Key': `${apiKey}`,\n      },\n    });\n\n    const data = await response.json();\n\n    if (data.status !== 200) {\n      switch (data.status) {\n        case 404:\n          clearResults();\n          setIsLoading(false);\n          setErrorMessage('No results');\n          break;\n        case 403:\n          clearResults();\n          setIsLoading(false);\n          setErrorMessage('Unauthorized API key');\n          break;\n        case 401:\n          clearResults();\n          setIsLoading(false);\n          setErrorMessage('API key required');\n          break;\n        case 429:\n          clearResults();\n          setIsLoading(false);\n          setErrorMessage('API rate limit reached');\n          break;\n        default:\n          clearResults();\n          setIsLoading(false);\n          setErrorMessage(data.error.message);\n          break;\n      }\n      return;\n    }\n\n    setSearchResults(data.data);\n    setIsLoading(false);\n  };\n\n  const debounce = (cb: () => void, delay = 250) => {\n    let debouncedTimeout: ReturnType<typeof setTimeout> | null = timer.current;\n    if (debouncedTimeout !== null) clearTimeout(debouncedTimeout);\n\n    return () => {\n      debouncedTimeout = setTimeout(() => {\n        cb();\n      }, delay);\n    };\n  };\n\n  useEffect(() => {\n    if (focus) debounce(fetchResults)();\n  }, [searchTerm, focus]);\n\n  const blur = () => {\n    setFocus(false);\n    const autoInput: HTMLInputElement | null = document.querySelector('.pdl-auto-input');\n    if (autoInput !== null) { autoInput.blur(); }\n  };\n\n  const mouseDownHandler = (e: React.MouseEvent) => {\n    if (searchResults.length === 0) return;\n\n    if (e.type === 'mousedown') {\n      const selected: HTMLInputElement | null = document.querySelector('.pdl-selected');\n\n      if (selected !== null) {\n        const selectedTerm: string | null = selected.getAttribute('data-value');\n\n        if (selectedTerm !== null) {\n          setSearchTerm(selectedTerm);\n          onTermSelected(selectedTerm);\n        }\n      }\n    }\n    blur();\n  };\n\n  const keyDownHandler = (e: React.KeyboardEvent) => {\n    if (searchResults.length === 0) return;\n\n    if (e.type === 'keydown') {\n      switch (e.key) {\n        case 'Enter': {\n          const selected: HTMLInputElement | null = document.querySelector('.pdl-selected');\n\n          if (selected !== null) {\n            const selectedTerm = selected.getAttribute('data-value');\n\n            if (selectedTerm !== null) {\n              setSearchTerm(selectedTerm);\n              onTermSelected(selectedTerm);\n            }\n          }\n          blur();\n          break;\n        }\n        case 'ArrowDown':\n          if (isActive === (searchResults.length - 1) || (isActive === null)) {\n            setIsActive(0);\n          } else {\n            const toAdd = isActive;\n            setIsActive(toAdd + 1);\n          }\n          break;\n        case 'ArrowUp':\n          if (isActive === 0 || isActive === null) {\n            setIsActive(searchResults.length - 1);\n          } else {\n            const toSubtract = isActive;\n            setIsActive(toSubtract - 1);\n          }\n          break;\n        case 'Escape':\n          blur();\n          break;\n        default:\n          break;\n      }\n    }\n  };\n\n  const placeholderText = () => {\n    switch (field) {\n      case 'company':\n        return 'IE: people data labs';\n      case 'country':\n        return 'IE: [\"united states\"]';\n      case 'industry':\n        return 'IE: computer software';\n      case 'location':\n        return 'IE: berkeley, california, united states';\n      case 'major':\n        return 'IE: [\"entrepreneurship\"]';\n      case 'region':\n        return 'IE: [\"california, united states\"]';\n      case 'role':\n        return 'IE: operations';\n      case 'sub_role':\n        return 'IE: logistics';\n      case 'school':\n        return 'IE: university of texas at austin';\n      case 'skill':\n        return 'IE: data analysis';\n      case 'title':\n        return 'IE: co-founder and chief executive officer';\n      default:\n        return '';\n    }\n  };\n\n  return (\n    <div className=\"pdl-autocomplete-wrapper\">\n      <div className={`pdl-auto-input-wrapper pdl-df pdl-row ${focus ? 'pdl-input-wrapper-focus' : ''}`}>\n        <input\n          className=\"pdl-auto-input\"\n          placeholder={placeholder || placeholderText()}\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.currentTarget.value)}\n          onFocus={() => setFocus(true)}\n          onBlur={() => setFocus(false)}\n          onKeyDown={(e) => keyDownHandler(e)}\n        />\n        <div className={`pdl-loading-spinner ${isLoading ? '' : 'pdl-dn'}`} />\n      </div>\n      <div className=\"pdl-autocomplete\">\n        <div className={`pdl-suggestions ${!focus || !searchResults.length ? 'pdl-dn' : ''}`}>\n          {(searchResults.length > 0)\n            ? searchResults.map((searchResult, idx) => (\n              <div\n                key={idx}\n                className={`pdl-suggestion pdl-df pdl-row ${idx === isActive ? 'pdl-selected' : ''}`}\n                data-value={searchResult.name}\n                data-idx={idx}\n                onMouseOver={(e) => {\n                  const indexString: string | undefined = e.currentTarget.dataset.idx;\n                  if (indexString) setIsActive(parseInt(indexString, 10));\n                }}\n                onMouseDown={(e) => mouseDownHandler(e)}\n              >\n                <div className=\"pdl-suggestion-name\">\n                  {searchResult.name}\n                </div>\n                <div className=\"pdl-suggestion-count\">\n                  {searchResult.count ? `(${searchResult.count.toLocaleString('en-US')})` : null}\n                </div>\n              </div>\n            )) : null}\n        </div>\n        <div className={`pdl-suggestions-pending\n          ${(focus === false) || isLoading || errorMessage || (searchResults.length > 0) ? 'pdl-dn' : ''}`}\n        >\n          Start typing to get suggestions\n        </div>\n        <div className={`pdl-suggestions-error\n          ${(errorMessage.length === 0) || (!focus) || (searchTerm.length === 0) ? 'pdl-dn' : ''}`}\n        >\n          {errorMessage}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Autocomplete;\n"],"names":[],"version":3,"file":"index.js.map"}